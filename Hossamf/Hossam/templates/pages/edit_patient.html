{% load static %}
{% block  content %}


<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,700,900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="{% static 'fonts/icomoon/style.css' %}">


  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">

  <!-- Style -->
  <link rel="stylesheet" href="{% static 'css/style.css' %}">

  <title>Edite Form</title>
</head>

<body>
    <div class="content">
        <div class="container">
            <div class="row align-items-stretch no-gutters contact-wrap">
                <div class="col-md-12">
                    <div class="form h-100">
                        <h3>Edit Patient</h3>
                        {% if error %}
                            <div class="alert alert-danger">{{ error }}</div>
                        {% endif %}
                        <form class="mb-5" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="row">
                                <div class="col-md-6 form-group mb-3">
                                    <label for="name" class="col-form-label">Name *</label>
                                    <input type="text" class="form-control" name="name" id="name" value="{{ patient.name }}">
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="email" class="col-form-label">Email *</label>
                                    <input type="text" class="form-control" name="email" id="email" value="{{ patient.email }}">
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="Birth_date" class="col-form-label">Birth Date *</label>
                                    <input type="date" class="form-control" name="Birth_date" id="Birth_date" value="{{ patient.Birth_date|date:"Y-m-d" }}" onchange="calculateAgeAndSetTypeOrder()">
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="phone_number" class="col-form-label">Phone Number *</label>
                                    <input type="tel" class="form-control" name="phone_number" id="phone_number" value="{{ patient.phone_number }}">
                                </div>
                                <div class="col-md-12 form-group mb-3">
                                    <label for="address" class="col-form-label">Address *</label>
                                    <input type="text" class="form-control" name="address" id="address" value="{{ patient.address }}">
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="suger_year" class="col-form-label">Age *</label>
                                    <input type="tel" class="form-control" name="suger_year" id="suger_year" value="{{ patient.suger_year }}" readonly>
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="type_order" class="col-form-label">Type order *</label>
                                    <input type="number" class="form-control" name="type_order" id="type_order" value="{{ patient.type_order }}" readonly>
                                </div>
                                <div class="col-md-12 form-group mb-3">
                                    <label for="cumulative_glucose_test" class="col-form-label">Cumulative glucose test *</label>
                                    <input type="tel" class="form-control" name="cumulative_glucose_test" id="cumulative_glucose_test" value="{{ patient.cumulative_glucose_test }}">
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="heart_diseases" class="col-form-label">Heart disease *</label>
                                    <select class="custom-select" id="heart_diseases" name="heart_diseases">
                                        <option value="yes" {% if patient.heart_diseases == 'yes' %}selected{% endif %}>Yes</option>
                                        <option value="No" {% if patient.heart_diseases == 'No' %}selected{% endif %}>No</option>
                                    </select>
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="blood_pressure" class="col-form-label">Blood pressure *</label>
                                    <input type="tel" class="form-control" name="blood_pressure" id="blood_pressure" value="{{ patient.blood_pressure }}">
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="cholestrol_level" class="col-form-label">Cholesterol level *</label>
                                    <input type="tel" class="form-control" name="cholestrol_level" id="cholestrol_level" value="{{ patient.cholestrol_level }}">
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="smoker" class="col-form-label">Smoker ? *</label>
                                    <select class="custom-select" id="smoker" name="smoker">
                                        <option value="yes" {% if patient.smoker == 'yes' %}selected{% endif %}>Yes</option>
                                        <option value="No" {% if patient.smoker == 'No' %}selected{% endif %}>No</option>
                                    </select>
                                </div>
                                <div class="col-md-12 form-group mb-3">
                                    <label for="Notes" class="col-form-label">Notes *</label>
                                    <textarea class="form-control" name="Notes" id="Notes" cols="30" rows="4">{{ patient.Notes }}</textarea>
                                </div>
                                <div class="col-md-12 form-group mb-3">
                                    <input type="file" id="imageInput" name="image" accept="image/*">
                                    <label for="imageInput" id="imageLabel">Select an image</label>
                                    {% if patient.image %}
                                        <img src="{{ patient.image.url }}" alt="Patient Image" width="100">
                                    {% endif %}
                                </div>
                                <div class="col-md-12 form-group">
                                    <input type="submit" value="Update Patient" class="btn btn-primary rounded-0 py-2 px-4">
                                    <span class="submitting"></span>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
    function calculateAgeAndSetTypeOrder() {
        const birthDate = new Date(document.getElementById('Birth_date').value);
        const today = new Date();
        let age = today.getFullYear() - birthDate.getFullYear();
        const monthDifference = today.getMonth() - birthDate.getMonth();
    
        if (monthDifference < 0 || (monthDifference === 0 && today.getDate() < birthDate.getDate())) {
            age--;
        }
    
        document.getElementById('suger_year').value = age;
        document.getElementById('type_order').value = age < 40 ? 1 : 2;
    }
    
    // Set initial value for suger_year and type_order on page load
    document.addEventListener("DOMContentLoaded", function() {
        calculateAgeAndSetTypeOrder();
    });
    </script>
</body>

        




  <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
  <script src="{% static 'js/popper.min.js' %}"></script>
  <script src="{% static 'js/bootstrap.min.js' %}"></script>
  <script src="{% static 'js/jquery.validate.min.js' %}"></script>


</body>

</html>
{% endblock content  %}